!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Zoom=t()}(this,(function(){"use strict";return function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".zoom-bg,.zoom-img{cursor:zoom-out;z-index:90000}.zoom-img{display:block;position:absolute;transition:transform .3s ease-in-out;will-change:transform}.zoom-bg{background:#121212;height:100vh;left:0;opacity:0;position:fixed;top:0;transition:opacity .3s ease-in-out;width:100vw;will-change:opacity}.zoom-bg.zoom-bg--reveal{opacity:.95}.zoom-original--hidden{visibility:hidden}"),function(e,{background:t,onTransitionEnd:n}){const o={screenWidth:0,screenHeight:0,scrollBar:0},i=()=>{const{documentElement:e}=document;o.screenWidth=window.innerWidth||e.clientWidth,o.screenHeight=window.innerHeight||e.clientHeight,o.scrollBar=o.screenWidth-e.offsetWidth},r=e=>{const i=e.currentSrc||e.src,{srcset:r}=e,{screenWidth:s,screenHeight:d,scrollBar:a}=o,{width:c,height:l,left:m,top:h}=e.getBoundingClientRect(),g=(s-a)/2-m-c/2,u=(d-l)/2-h,f=document.createElement("div"),p=document.createElement("img");let v=e.naturalWidth;const y=()=>{f.classList.remove("zoom-bg--reveal"),p.style.transform="",p.addEventListener("transitionend",(()=>{f.remove(),e.classList.remove("zoom-original--hidden"),p.remove()}),{once:!0}),f.removeEventListener("click",y),p.removeEventListener("click",y),window.removeEventListener("scroll",y),window.removeEventListener("resize",y)};if(f.classList.add("zoom-bg"),t)if("auto"===t){const t=function(e){const t={r:0,g:0,b:0},n=document.createElement("canvas"),o=n.getContext("2d");if(!o)return null;const i=n.width=e.naturalWidth||e.offsetWidth||e.width,r=n.height=e.naturalHeight||e.offsetHeight||e.height;let s,d,a=-4,c=0;o.drawImage(e,0,0);try{s=o.getImageData(0,0,i,r)}catch(e){return null}for(d=s.data.length;(a+=20)<d;)++c,t.r+=s.data[a],t.g+=s.data[a+1],t.b+=s.data[a+2];return t.r=Math.floor(t.r/c),t.g=Math.floor(t.g/c),t.b=Math.floor(t.b/c),t}(e);f.style.background=t?`rgb(${t.r}, ${t.g}, ${t.b})`:"rgb(0, 0, 0)"}else f.style.background=t;if(r){const e=r.match(/ ([0-9]+)w/gm);e&&(v=e.map((e=>+e.trim().replace("w",""))).filter((e=>!Number.isNaN(e))).reduce(((e,t)=>Math.max(e,t)),0))}const w=l/c;v=Math.min(v,s);const b=v*w;b>=d&&(v=v*d/b),p.classList.add("zoom-img"),p.src=i,p.width=c,p.height=l,f.addEventListener("click",y,{once:!0}),p.addEventListener("click",y,{once:!0}),window.addEventListener("scroll",y,{once:!0,passive:!0}),window.addEventListener("resize",y,{once:!0,passive:!0}),document.body.append(f,p),p.style.top=`${h+window.scrollY}px`,p.style.left=`${m}px`,p.style.width=`${c}px`,p.style.height=`${l}px`,e.classList.add("zoom-original--hidden");const E=v!==c?v/c:1;p.style.transform=`matrix(${E}, 0, 0, ${E}, ${g}, ${u})`,f.classList.add("zoom-bg--reveal"),p.addEventListener("transitionend",(()=>{null==n||n(p)}),{once:!0})},s=e=>{r(e.target)},d=e=>{if(e){if("string"==typeof e){document.querySelectorAll(e).forEach(a);const t=document.createElement("style"),n=document.head||document.getElementsByTagName("head")[0];return t.appendChild(document.createTextNode(`${e}{cursor:zoom-in}`)),void n.appendChild(t)}e instanceof HTMLElement?a(e):e.forEach(a)}},a=e=>{var t;e instanceof HTMLElement&&("IMG"!==e.tagName?null===(t=e.querySelector("img"))||void 0===t||t.addEventListener("click",s):e.addEventListener("click",s))};return i(),window.addEventListener("resize",i,{passive:!0}),d(e),{zoom:r,attach:d}}}));
